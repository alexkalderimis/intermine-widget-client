<!DOCTYPE html>  <html> <head>   <title>mynd.coffee</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="ChartWidget.html">                 ChartWidget.coffee               </a>                                           <a class="source" href="EnrichmentWidget.html">                 EnrichmentWidget.coffee               </a>                                           <a class="source" href="InterMineWidget.html">                 InterMineWidget.coffee               </a>                                           <a class="source" href="TableWidget.html">                 TableWidget.coffee               </a>                                           <a class="source" href="charts.html">                 charts.coffee               </a>                                           <a class="source" href="exporter.html">                 exporter.coffee               </a>                                           <a class="source" href="ie.html">                 ie.coffee               </a>                                           <a class="source" href="merge.html">                 merge.coffee               </a>                                           <a class="source" href="mynd.html">                 mynd.coffee               </a>                                           <a class="source" href="types.html">                 types.coffee               </a>                                           <a class="source" href="widgets.html">                 widgets.coffee               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               mynd.coffee             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <h1>Mynd/Chart means/þýðir chart/mynd in/í icelandic/íslensku</h1>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">Mynd = </span><span class="p">{}</span>
<span class="nv">Mynd.Scale = </span><span class="p">{}</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>Ordinal scales have a discrete domain (chart bars).</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">Mynd.Scale.ordinal = </span><span class="o">-&gt;</span>
    <span class="p">(</span> <span class="o">-&gt;</span>
        <span class="nv">internal = </span><span class="p">{}</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Given a value <code>x</code> in the input domain, returns the corresponding value in the output range.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nv">scale = </span><span class="nf">(x) -&gt;</span>
            <span class="k">if</span> <span class="o">not</span> <span class="nx">internal</span><span class="p">.</span><span class="nx">range</span><span class="o">?</span> <span class="k">then</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span> <span class="s1">&#39;Mynd.Scale.ordinal: you need to set input range first&#39;</span>
            
            <span class="nx">internal</span><span class="p">.</span><span class="nx">range</span><span class="p">[</span><span class="nx">x</span><span class="p">]</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Sets the input domain of the ordinal scale to the specified array of values. The first element in values will
 be mapped to the first element in the output range, the second domain value to the second range value, and so
 on.
Example: [0..5] for 5 chart bars</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nv">scale.setDomain = </span><span class="nf">(domain = []) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>Make sure the domain is actually discrete.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nv">d = </span><span class="p">{}</span>
            <span class="k">for</span> <span class="nx">element</span> <span class="k">in</span> <span class="nx">domain</span> <span class="k">then</span> <span class="nx">d</span><span class="p">[</span><span class="nx">element</span><span class="p">]</span> <span class="o">=</span> <span class="nx">element</span>
            <span class="nv">internal.domain = </span><span class="p">(</span><span class="nx">value</span> <span class="k">for</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">value</span> <span class="k">of</span> <span class="nx">d</span><span class="p">)</span>

            <span class="nx">scale</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Sets the output range from the specified continuous interval. The array interval contains two elements
 representing the minimum and maximum numeric value. This interval is subdivided into n evenly-spaced bands,
 where n is the number of (unique) values in the domain.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>The <code>bands</code> may be offset from the edge of the interval and other bands according to the specified padding,
 which defaults to zero.
Example: [0, 400] for a column chart 400px wide</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>The <code>padding</code> is in the range [0,1] and corresponds to the amount of space in the range interval to allocate
 to padding.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nv">scale.setRangeBands = </span><span class="nf">(bands, padding = 0) -&gt;</span>
            <span class="k">if</span> <span class="o">not</span> <span class="nx">internal</span><span class="p">.</span><span class="nx">domain</span><span class="o">?</span> <span class="k">then</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span> <span class="s1">&#39;Mynd.Scale.ordinal: you need to set input domain first&#39;</span>

            <span class="nv">start = </span><span class="nx">bands</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">;</span> <span class="nv">stop = </span><span class="nx">bands</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            </pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>Do we need to reverse the range?</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nv">reverse = </span><span class="nx">bands</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="nx">bands</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="p">[</span><span class="nx">stop</span><span class="p">,</span> <span class="nx">start</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nx">start</span><span class="p">,</span> <span class="nx">stop</span><span class="p">]</span> <span class="k">if</span> <span class="nx">reverse</span>

            <span class="nv">step = </span><span class="p">(</span><span class="nx">stop</span> <span class="o">-</span> <span class="nx">start</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nx">internal</span><span class="p">.</span><span class="nx">domain</span><span class="p">.</span><span class="nx">length</span> <span class="o">+</span> <span class="nx">padding</span><span class="p">)</span>

            <span class="nv">range = </span><span class="p">[</span><span class="mi">0</span><span class="p">...</span><span class="nx">internal</span><span class="p">.</span><span class="nx">domain</span><span class="p">.</span><span class="nx">length</span><span class="p">].</span><span class="nx">map</span> <span class="nf">(i) -&gt;</span> <span class="p">(</span><span class="nx">start</span> <span class="o">+</span> <span class="p">(</span><span class="nx">step</span> <span class="o">*</span> <span class="nx">padding</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="nx">step</span> <span class="o">*</span> <span class="nx">i</span><span class="p">)</span>
            <span class="nx">range</span><span class="p">.</span><span class="nx">reverse</span><span class="p">()</span> <span class="k">if</span> <span class="nx">reverse</span>

            <span class="nv">internal.range = </span><span class="nx">range</span>
            <span class="nv">internal.rangeBand = </span><span class="nx">step</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="nx">padding</span><span class="p">)</span>

            <span class="nx">scale</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>Returns the band width.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nv">scale.getRangeBand = </span><span class="o">-&gt;</span> <span class="nx">internal</span><span class="p">.</span><span class="nx">rangeBand</span>

        <span class="nx">scale</span><span class="p">.</span><span class="nx">setDomain</span><span class="p">()</span>
    <span class="p">)()</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>Linear scales map a continuous input domain to a continuous output range.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">Mynd.Scale.linear = </span><span class="o">-&gt;</span>
    <span class="p">(</span> <span class="o">-&gt;</span>
        <span class="nv">internal = </span><span class="p">{}</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>Returns a numeric deinterpolator between two numbers <code>a</code> and <code>b</code> representing the domain (bar min/max values).</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nv">deinterpolate = </span><span class="nf">(a, b) -&gt;</span>
            <span class="nf">(x) -&gt;</span> <span class="p">(</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">a</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="nx">b</span> <span class="o">-</span> <span class="nx">a</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>Returns a numeric interpolator between the two numbers <code>a</code> and <code>b</code> representing the range (column chart height).</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nv">interpolate = </span><span class="nf">(a, b, round) -&gt;</span>
            <span class="k">if</span> <span class="nx">round</span>
                <span class="nf">(x) -&gt;</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span> <span class="o">*</span> <span class="nx">x</span>
            <span class="k">else</span>
                <span class="nf">(x) -&gt;</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span> <span class="o">*</span> <span class="nx">x</span>

        <span class="nv">scaleBilinear = </span><span class="nf">(domain, range, round) -&gt;</span>
            <span class="nf">(x) -&gt;</span> <span class="nx">interpolate</span><span class="p">(</span><span class="nx">range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">range</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nx">round</span><span class="p">)(</span> <span class="nx">deinterpolate</span><span class="p">(</span><span class="nx">domain</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">domain</span><span class="p">[</span><span class="mi">1</span><span class="p">])(</span> <span class="nx">x</span> <span class="p">)</span> <span class="p">)</span>
        
        <span class="nv">scale = </span><span class="nf">(x) -&gt;</span>
            <span class="k">if</span> <span class="o">not</span> <span class="nx">internal</span><span class="p">.</span><span class="nx">output</span><span class="o">?</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>Set domain and range?</p>             </td>             <td class="code">               <div class="highlight"><pre>                <span class="k">if</span> <span class="nx">internal</span><span class="p">.</span><span class="nx">domain</span><span class="o">?</span> <span class="o">and</span> <span class="nx">internal</span><span class="p">.</span><span class="nx">range</span><span class="o">?</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>...then apply bilinear scale de/interpolator.</p>             </td>             <td class="code">               <div class="highlight"><pre>                    <span class="nv">internal.output = </span><span class="nx">scaleBilinear</span> <span class="nx">internal</span><span class="p">.</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">internal</span><span class="p">.</span><span class="nx">range</span><span class="p">,</span> <span class="nx">internal</span><span class="p">.</span><span class="nx">round</span>
                <span class="k">else</span>
                    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span> <span class="s1">&#39;Mynd.Scale.linear: you need to set both input domain and range&#39;</span>

            <span class="nx">internal</span><span class="p">.</span><span class="nx">output</span> <span class="nx">x</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>Set the scale's input domain to the specified array of numbers.
Example: [0, 2] for bar values ranging from 0 to a maximum of 2</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nv">scale.setDomain = </span><span class="nf">(domain) -&gt;</span> <span class="nv">internal.domain = </span><span class="nx">domain</span> <span class="p">;</span> <span class="nx">scale</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>Sets the scale's output range to the specified array of values.
Enable <code>round</code> to get round numbers avoid antialiasing artifacts.
Example: [0, 100] for a column chart bar that is to be at most 100px tall.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nv">scale.setRange = </span><span class="nf">(range, round=false) -&gt;</span>
            <span class="nv">internal.range = </span><span class="nx">range</span>
            <span class="nv">internal.round = </span><span class="nx">round</span>

            <span class="nx">scale</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>Returns approximately count representative values from the scale's input domain. The returned tick values are
 uniformly spaced, have human-readable values (such as multiples of powers of 10), and are guaranteed to be
 within the extent of the input domain.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nv">scale.getTicks = </span><span class="nf">(amount) -&gt;</span>
            <span class="k">if</span> <span class="o">not</span> <span class="nx">internal</span><span class="p">.</span><span class="nx">domain</span><span class="o">?</span> <span class="k">then</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span> <span class="s1">&#39;Mynd.Scale.linear: you need to set input domain first&#39;</span>

            <span class="nv">start = </span><span class="nx">internal</span><span class="p">.</span><span class="nx">domain</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">;</span> <span class="nv">stop = </span><span class="nx">internal</span><span class="p">.</span><span class="nx">domain</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>Do we need to reverse the domain?</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nv">reverse = </span><span class="nx">internal</span><span class="p">.</span><span class="nx">domain</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="nx">internal</span><span class="p">.</span><span class="nx">domain</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="p">[</span><span class="nx">stop</span><span class="p">,</span> <span class="nx">start</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nx">start</span><span class="p">,</span> <span class="nx">stop</span><span class="p">]</span> <span class="k">if</span> <span class="nx">reverse</span>

            <span class="nv">span = </span><span class="nx">stop</span> <span class="o">-</span> <span class="nx">start</span>
            <span class="nv">step = </span><span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span> <span class="mi">10</span><span class="p">,</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">span</span> <span class="sr">/ amount ) /</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">LN10</span> <span class="p">)</span> <span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>Adjust the step.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nv">x = </span><span class="nx">amount</span> <span class="err">/ span * step</span>
            <span class="k">if</span> <span class="nx">x</span> <span class="o">&lt;=</span> <span class="p">.</span><span class="mi">15</span> <span class="k">then</span> <span class="nx">step</span> <span class="o">*=</span> <span class="mi">10</span>
            <span class="k">else</span> <span class="k">if</span> <span class="nx">x</span> <span class="o">&lt;=</span> <span class="p">.</span><span class="mi">35</span> <span class="k">then</span> <span class="nx">step</span> <span class="o">*=</span> <span class="mi">5</span>
            <span class="k">else</span> <span class="k">if</span> <span class="nx">x</span> <span class="o">&lt;=</span> <span class="p">.</span><span class="mi">75</span> <span class="k">then</span> <span class="nx">step</span> <span class="o">*=</span> <span class="mi">2</span>
            </pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>Create the ticks list.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nv">ticks = </span><span class="p">[]</span>
            <span class="nv">x = </span><span class="nb">Math</span><span class="p">.</span><span class="nx">ceil</span><span class="p">(</span><span class="nx">start</span> <span class="err">/ step) * step</span>
            <span class="p">(</span><span class="nx">ticks</span><span class="p">.</span><span class="nx">push</span> <span class="nx">x</span> <span class="p">;</span> <span class="nx">x</span> <span class="o">+=</span> <span class="nx">step</span><span class="p">)</span> <span class="k">while</span> <span class="nx">x</span> <span class="o">&lt;=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">stop</span> <span class="err">/ step) * step + step * .5</span>

            <span class="nx">ticks</span>

        <span class="nx">scale</span>
    <span class="p">)()</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 