(function(){var a={},b={};b["error.eco"]=function(a){a||(a={});var b=[],c=function(a){var c=b,d;return b=[],a.call(this),d=b.join(""),b=c,e(d)},d=function(a){return a&&a.ecoSafe?a:typeof a!="undefined"&&a!=null?g(a):""},e,f=a.safe,g=a.escape;return e=a.safe=function(a){if(a&&a.ecoSafe)return a;if(typeof a=="undefined"||a==null)a="";var b=new String(a);return b.ecoSafe=!0,b},g||(g=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){b.push('<div class="alert alert-block">\n    <h4 class="alert-heading">'),b.push(d(this.title)),b.push(" for "),b.push(d(this.name)),b.push("</h4>\n    <p>"),b.push(this.text),b.push("</p>\n</div>")}).call(this)}.call(a),a.safe=f,a.escape=g,b.join("")},b["actions.eco"]=function(a){a||(a={});var b=[],c=function(a){var c=b,d;return b=[],a.call(this),d=b.join(""),b=c,e(d)},d=function(a){return a&&a.ecoSafe?a:typeof a!="undefined"&&a!=null?g(a):""},e,f=a.safe,g=a.escape;return e=a.safe=function(a){if(a&&a.ecoSafe)return a;if(typeof a=="undefined"||a==null)a="";var b=new String(a);return b.ecoSafe=!0,b},g||(g=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){b.push('<a class="btn btn-small '),this.disabled&&b.push("disabled"),b.push(' view">View</a>\n<a class="btn btn-small '),this.disabled&&b.push("disabled"),b.push(' export">Download</a>')}).call(this)}.call(a),a.safe=f,a.escape=g,b.join("")},b["extra.eco"]=function(a){a||(a={});var b=[],c=function(a){var c=b,d;return b=[],a.call(this),d=b.join(""),b=c,e(d)},d=function(a){return a&&a.ecoSafe?a:typeof a!="undefined"&&a!=null?g(a):""},e,f=a.safe,g=a.escape;return e=a.safe=function(a){if(a&&a.ecoSafe)return a;if(typeof a=="undefined"||a==null)a="";var b=new String(a);return b.ecoSafe=!0,b},g||(g=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var a,c,e,f;b.push('<div class="group" style="display:inline-block;margin:0 5px 10px 0;float:left">\n    <label>'),b.push(d(this.label)),b.push("</label>\n    ");if(this.possible.length>1){b.push('\n        <select name="'),b.push(d(this.label)),b.push('" class="span2">\n            '),f=this.possible;for(c=0,e=f.length;c<e;c++)a=f[c],b.push('\n                <option value="'),b.push(d(a)),b.push('" '),this.selected===a&&b.push(d('selected="selected"')),b.push(">\n                    "),b.push(d(a)),b.push("\n                </option>\n            ");b.push("\n        </select>\n    ")}else b.push("\n        "),b.push(d(this.possible[0])),b.push("\n    ");b.push('\n</div>\n<div style="clear:both"></div>')}).call(this)}.call(a),a.safe=f,a.escape=g,b.join("")},b["noresults.eco"]=function(a){a||(a={});var b=[],c=function(a){var c=b,d;return b=[],a.call(this),d=b.join(""),b=c,e(d)},d=function(a){return a&&a.ecoSafe?a:typeof a!="undefined"&&a!=null?g(a):""},e,f=a.safe,g=a.escape;return e=a.safe=function(a){if(a&&a.ecoSafe)return a;if(typeof a=="undefined"||a==null)a="";var b=new String(a);return b.ecoSafe=!0,b},g||(g=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){b.push('<div class="alert alert-info">\n    <p>The Widget has no results.</p>\n</div>')}).call(this)}.call(a),a.safe=f,a.escape=g,b.join("")},b["loading.eco"]=function(a){a||(a={});var b=[],c=function(a){var c=b,d;return b=[],a.call(this),d=b.join(""),b=c,e(d)},d=function(a){return a&&a.ecoSafe?a:typeof a!="undefined"&&a!=null?g(a):""},e,f=a.safe,g=a.escape;return e=a.safe=function(a){if(a&&a.ecoSafe)return a;if(typeof a=="undefined"||a==null)a="";var b=new String(a);return b.ecoSafe=!0,b},g||(g=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){b.push('<div class="loading" style="background:rgba(255,255,255,0.9);position:absolute;top:0;left:0;height:100%;width:100%;text-align:center;">\n    <p style="padding-top:50%;font-weight:bold;">Loading &hellip;</p>\n</div>')}).call(this)}.call(a),a.safe=f,a.escape=g,b.join("")},b["invalidjsonkey.eco"]=function(a){a||(a={});var b=[],c=function(a){var c=b,d;return b=[],a.call(this),d=b.join(""),b=c,e(d)},d=function(a){return a&&a.ecoSafe?a:typeof a!="undefined"&&a!=null?g(a):""},e,f=a.safe,g=a.escape;return e=a.safe=function(a){if(a&&a.ecoSafe)return a;if(typeof a=="undefined"||a==null)a="";var b=new String(a);return b.ecoSafe=!0,b},g||(g=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){b.push('<li style="vertical-align:bottom">\n    <span style="display:inline-block" class="label label-important">'),b.push(d(this.key)),b.push("</span> is "),b.push(d(this.actual)),b.push("; was expecting "),b.push(d(this.expected)),b.push("\n</li>")}).call(this)}.call(a),a.safe=f,a.escape=g,b.join("")},b["popover.values.eco"]=function(a){a||(a={});var b=[],c=function(a){var c=b,d;return b=[],a.call(this),d=b.join(""),b=c,e(d)},d=function(a){return a&&a.ecoSafe?a:typeof a!="undefined"&&a!=null?g(a):""},e,f=a.safe,g=a.escape;return e=a.safe=function(a){if(a&&a.ecoSafe)return a;if(typeof a=="undefined"||a==null)a="";var b=new String(a);return b.ecoSafe=!0,b},g||(g=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var a,c,e,f;b.push("<h4>"),b.push(d(this.values.length)),b.push(" "),b.push(d(this.type)),this.values.length!==1&&b.push(d("s")),b.push(":</h4>\n\n"),f=this.values.slice(0,this.valuesLimit-1+1||9e9);for(c=0,e=f.length;c<e;c++)a=f[c],b.push('\n    <a href="#" class="match">'),b.push(d(a)),b.push("</a>\n");b.push("\n"),this.values.length>this.valuesLimit&&b.push("&hellip;")}).call(this)}.call(a),a.safe=f,a.escape=g,b.join("")},b["popover.eco"]=function(a){a||(a={});var b=[],c=function(a){var c=b,d;return b=[],a.call(this),d=b.join(""),b=c,e(d)},d=function(a){return a&&a.ecoSafe?a:typeof a!="undefined"&&a!=null?g(a):""},e,f=a.safe,g=a.escape;return e=a.safe=function(a){if(a&&a.ecoSafe)return a;if(typeof a=="undefined"||a==null)a="";var b=new String(a);return b.ecoSafe=!0,b},g||(g=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){b.push('<div class="popover" style="position:absolute;top:5px;right:0;z-index:1;display:block">\n    <div class="popover-inner" style="'),b.push(d(this.style)),b.push('">\n        <a style="cursor:pointer;margin:2px 5px 0 0" class="close">Ã—</a>\n        <h3 class="popover-title">\n            '),b.push(d(this.description.slice(0,this.descriptionLimit-1+1||9e9))),b.push("\n            "),this.description.length>this.descriptionLimit&&b.push("&hellip;"),b.push('\n        </h3>\n        <div class="popover-content">\n            <div class="values">\n                <!-- popover.values.eco -->\n            </div>\n            <div style="margin-top:10px">\n                <a class="btn btn-small btn-primary results">View results</a>\n                <a class="btn btn-small list disabled">Create list</a>\n            </div>\n        </div>\n    </div>\n</div>')}).call(this)}.call(a),a.safe=f,a.escape=g,b.join("")},b["chart.eco"]=function(a){a||(a={});var b=[],c=function(a){var c=b,d;return b=[],a.call(this),d=b.join(""),b=c,e(d)},d=function(a){return a&&a.ecoSafe?a:typeof a!="undefined"&&a!=null?g(a):""},e,f=a.safe,g=a.escape;return e=a.safe=function(a){if(a&&a.ecoSafe)return a;if(typeof a=="undefined"||a==null)a="";var b=new String(a);return b.ecoSafe=!0,b},g||(g=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){b.push('<div class="header">\n    <h3>'),this.title&&b.push(d(this.title)),b.push('</h3>\n    <p style="margin:0">'),this.description&&b.push(this.description),b.push("</p>\n    "),this.notAnalysed&&(b.push('\n        <p style="margin:10px 0 0 0">Number of Genes in this list not analysed in this widget: <a>'),b.push(d(this.notAnalysed)),b.push("</a></p>\n    ")),b.push('\n\n    <div class="form">\n        <form style="margin:0;padding:10px 0 0 0">\n            <!-- extra.eco -->\n        </form>\n    </div>\n</div>\n<div class="content">\n    <div class="settings"></div>\n    <div class="legend"></div>\n    <div class="chart"></div>\n</div>')}).call(this)}.call(a),a.safe=f,a.escape=g,b.join("")},b["enrichment.row.eco"]=function(a){a||(a={});var b=[],c=function(a){var c=b,d;return b=[],a.call(this),d=b.join(""),b=c,e(d)},d=function(a){return a&&a.ecoSafe?a:typeof a!="undefined"&&a!=null?g(a):""},e,f=a.safe,g=a.escape;return e=a.safe=function(a){if(a&&a.ecoSafe)return a;if(typeof a=="undefined"||a==null)a="";var b=new String(a);return b.ecoSafe=!0,b},g||(g=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){b.push('<td class="check"><input type="checkbox" '),this.row.selected&&b.push('checked="checked"'),b.push(' /></td>\n<td class="description">\n    '),b.push(d(this.row.description)),b.push("\n    "),this.row.externalLink&&(b.push('\n        [<a href="'),b.push(this.row.externalLink),b.push('" target="_blank">Link</a>]\n    ')),b.push('\n</td>\n<td class="pValue">'),b.push(d(this.row["p-value"].toPrecision(5))),b.push('</td>\n<td class="matches">\n    <a class="count" style="cursor:pointer">'),b.push(d(this.row.matches)),b.push("</a>\n</td>")}).call(this)}.call(a),a.safe=f,a.escape=g,b.join("")},b["enrichment.eco"]=function(a){a||(a={});var b=[],c=function(a){var c=b,d;return b=[],a.call(this),d=b.join(""),b=c,e(d)},d=function(a){return a&&a.ecoSafe?a:typeof a!="undefined"&&a!=null?g(a):""},e,f=a.safe,g=a.escape;return e=a.safe=function(a){if(a&&a.ecoSafe)return a;if(typeof a=="undefined"||a==null)a="";var b=new String(a);return b.ecoSafe=!0,b},g||(g=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){b.push('<div class="header">\n    <h3>'),this.title&&b.push(d(this.title)),b.push("</h3>\n    <p>"),this.description&&b.push(this.description),b.push("</p>\n    "),this.notAnalysed&&(b.push("\n        <p>Number of Genes in this list not analysed in this widget: <a>"),b.push(d(this.notAnalysed)),b.push("</a></p>\n    ")),b.push('\n\n    <div class="form">\n        <!-- enrichment.form.eco -->\n    </div>\n\n    <div class="actions" style="padding:10px 0">\n        <!-- actions.eco -->\n    </div>\n</div>\n<div class="content">\n    <!-- enrichment.table.eco -->\n</div>')}).call(this)}.call(a),a.safe=f,a.escape=g,b.join("")},b["enrichment.table.eco"]=function(a){a||(a={});var b=[],c=function(a){var c=b,d;return b=[],a.call(this),d=b.join(""),b=c,e(d)},d=function(a){return a&&a.ecoSafe?a:typeof a!="undefined"&&a!=null?g(a):""},e,f=a.safe,g=a.escape;return e=a.safe=function(a){if(a&&a.ecoSafe)return a;if(typeof a=="undefined"||a==null)a="";var b=new String(a);return b.ecoSafe=!0,b},g||(g=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){b.push('<!-- actual fixed head -->\n<div class="head" style="display:table">\n    <div style="font-weight:bold;display:table-cell;padding:0 8px;"><input type="checkbox" class="check" /></div>\n    <div style="font-weight:bold;display:table-cell;padding:0 8px;">'),b.push(d(this.label)),b.push('</div>\n    <div style="font-weight:bold;display:table-cell;padding:0 8px;">p-Value</div>\n    <div style="font-weight:bold;display:table-cell;padding:0 8px;">Matches</div>\n    <div style="clear:both"></div>\n</div>\n<div class="wrapper" style="overflow:auto;overflow-x:hidden">\n    <table class="table table-striped">\n        <!-- head for proper cell width -->\n        <thead style="visibility:hidden">\n            <tr>\n                <th></th>\n                <th>'),b.push(d(this.label)),b.push("</th>\n                <th>p-Value</th>\n                <th>Matches</th>\n            </tr>\n        </thead>\n        <tbody>\n            <!-- loop enrichment.row.eco -->\n        </tbody>\n    </table>\n</div>")}).call(this)}.call(a),a.safe=f,a.escape=g,b.join("")},b["enrichment.form.eco"]=function(a){a||(a={});var b=[],c=function(a){var c=b,d;return b=[],a.call(this),d=b.join(""),b=c,e(d)},d=function(a){return a&&a.ecoSafe?a:typeof a!="undefined"&&a!=null?g(a):""},e,f=a.safe,g=a.escape;return e=a.safe=function(a){if(a&&a.ecoSafe)return a;if(typeof a=="undefined"||a==null)a="";var b=new String(a);return b.ecoSafe=!0,b},g||(g=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var a,c,e,f,g,h,i,j;b.push('<form style="margin:0">\n    <div class="group" style="display:inline-block;margin-right:5px;float:left">\n        <label>Test Correction</label>\n        <select name="errorCorrection" class="span2">\n            '),i=this.errorCorrections;for(e=0,g=i.length;e<g;e++)a=i[e],b.push('\n                <option value="'),b.push(d(a)),b.push('" '),this.options.errorCorrection===a&&b.push(d('selected="selected"')),b.push(">\n                    "),b.push(d(a)),b.push("\n            </option>\n            ");b.push('\n        </select>\n    </div>\n\n    <div class="group" style="display:inline-block;margin-right:5px;float:left">\n        <label>Max p-value</label>\n        <select name="pValue" class="span2">\n            '),j=this.pValues;for(f=0,h=j.length;f<h;f++)c=j[f],b.push('\n                <option value="'),b.push(d(c)),b.push('" '),this.options.pValue===c&&b.push(d('selected="selected"')),b.push(">\n                    "),b.push(d(c)),b.push("\n                </option>\n            ");b.push('\n        </select>\n    </div>\n</form>\n<div style="clear:both"></div>')}).call(this)}.call(a),a.safe=f,a.escape=g,b.join("")},b["table.row.eco"]=function(a){a||(a={});var b=[],c=function(a){var c=b,d;return b=[],a.call(this),d=b.join(""),b=c,e(d)},d=function(a){return a&&a.ecoSafe?a:typeof a!="undefined"&&a!=null?g(a):""},e,f=a.safe,g=a.escape;return e=a.safe=function(a){if(a&&a.ecoSafe)return a;if(typeof a=="undefined"||a==null)a="";var b=new String(a);return b.ecoSafe=!0,b},g||(g=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var a,c,e,f;b.push('<td class="check"><input type="checkbox" '),this.row.selected&&b.push('checked="checked"'),b.push(" /></td>\n"),f=this.row.descriptions;for(c=0,e=f.length;c<e;c++)a=f[c],b.push("\n    <td>"),b.push(d(a)),b.push("</td>\n");b.push("\n<td>"),b.push(d(this.row.matches)),b.push("</td>")}).call(this)}.call(a),a.safe=f,a.escape=g,b.join("")},b["table.eco"]=function(a){a||(a={});var b=[],c=function(a){var c=b,d;return b=[],a.call(this),d=b.join(""),b=c,e(d)},d=function(a){return a&&a.ecoSafe?a:typeof a!="undefined"&&a!=null?g(a):""},e,f=a.safe,g=a.escape;return e=a.safe=function(a){if(a&&a.ecoSafe)return a;if(typeof a=="undefined"||a==null)a="";var b=new String(a);return b.ecoSafe=!0,b},g||(g=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){b.push('<div class="header">\n    <h3>'),this.title&&b.push(d(this.title)),b.push("</h3>\n    <p>"),this.description&&b.push(this.description),b.push("</p>\n    "),this.notAnalysed&&(b.push("\n        <p>Number of Genes in this list not analysed in this widget: <a>"),b.push(d(this.notAnalysed)),b.push("</a></p>\n    ")),b.push('\n\n    <div class="actions" style="padding:10px 0">\n        <!-- actions.eco -->\n    </div>\n</div>\n<div class="content">\n    <!-- table.table.eco -->\n</div>')}).call(this)}.call(a),a.safe=f,a.escape=g,b.join("")},b["table.table.eco"]=function(a){a||(a={});var b=[],c=function(a){var c=b,d;return b=[],a.call(this),d=b.join(""),b=c,e(d)},d=function(a){return a&&a.ecoSafe?a:typeof a!="undefined"&&a!=null?g(a):""},e,f=a.safe,g=a.escape;return e=a.safe=function(a){if(a&&a.ecoSafe)return a;if(typeof a=="undefined"||a==null)a="";var b=new String(a);return b.ecoSafe=!0,b},g||(g=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var a,c,e,f,g,h,i;b.push('<!-- actual fixed head -->\n<div class="head" style="display:table">\n    <div style="font-weight:bold;display:table-cell;padding:0 8px;"><input type="checkbox" class="check" /></div>\n    '),h=this.columns;for(c=0,f=h.length;c<f;c++)a=h[c],b.push('\n        <div style="font-weight:bold;display:table-cell;padding:0 8px;">'),b.push(d(a)),b.push("</div>\n    ");b.push('\n    <div style="clear:both"></div>\n</div>\n<div class="wrapper" style="overflow:auto;overflow-x:hidden">\n    <table class="table table-striped">\n        <!-- head for proper cell width -->\n        <thead style="visibility:hidden">\n            <tr>\n                <th></th>\n                '),i=this.columns;for(e=0,g=i.length;e<g;e++)a=i[e],b.push("\n                    <th>"),b.push(d(a)),b.push("</th>\n                ");b.push("\n            </tr>\n        </thead>\n        <tbody>\n            <!-- loop table.row.eco -->\n        </tbody>\n    </table>\n</div>")}).call(this)}.call(a),a.safe=f,a.escape=g,b.join("")};var c,d={}.hasOwnProperty,e=function(a,b){function e(){this.constructor=a}for(var c in b)d.call(b,c)&&(a[c]=b[c]);return e.prototype=b.prototype,a.prototype=new e,a.__super__=b.prototype,a};c={},c.Root=function(){function a(){}return a.name="Root",a.prototype.result=!1,a.prototype.is=function(){return this.result},a.prototype.toString=function(){return""+this.expected+" but got "+this.actual},a}(),c.isString=function(a){function b(a){this.actual=a,this.result=typeof a=="string"}return e(b,a),b.name="isString",b.prototype.expected="String",b}(c.Root),c.isInteger=function(a){function b(a){this.actual=a,this.result=typeof a=="number"}return e(b,a),b.name="isInteger",b.prototype.expected="Integer",b}(c.Root),c.isBoolean=function(a){function b(a){this.actual=a,this.result=typeof a=="boolean"}return e(b,a),b.name="isBoolean",b.prototype.expected="Boolean true",b}(c.Root),c.isNull=function(a){function b(a){this.actual=a,this.result=a===null}return e(b,a),b.name="isNull",b.prototype.expected="Null",b}(c.Root),c.isArray=function(a){function b(a){this.actual=a,this.result=a instanceof Array}return e(b,a),b.name="isArray",b.prototype.expected="Array",b}(c.Root),c.isHTTPSuccess=function(a){function b(a){this.actual=a,this.result=a===200}return e(b,a),b.name="isHTTPSuccess",b.prototype.expected="HTTP code 200",b}(c.Root),c.isJSON=function(a){function b(a){this.actual=a,this.result=!0;try{typeof JSON!="undefined"&&JSON!==null&&JSON.parse(a)}catch(b){this.result=!1}}return e(b,a),b.name="isJSON",b.prototype.expected="JSON Object",b}(c.Root),c.isUndefined=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.name="isUndefined",b.prototype.expected="it to be undefined",b}(c.Root);var f;f=function(a,b){var c;for(c in b)a[c]==null&&Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c]);return a};var g;g={expliticize:function(a){var b,c,d,e,f;switch(a.node().nodeName){case"rect":b=["fill","stroke"];break;case"text":b=["fill","font-family","font-size"];break;case"line":b=["stroke"]}f=[];for(d=0,e=b.length;d<e;d++)c=b[d],f.push(a.attr(c,window.getComputedStyle(a.node(),null).getPropertyValue(c)));return f},toPNG:function(a,b,c){var d;return d=F("<canvas/>",{style:"image-rendering:-moz-crisp-edges;image-rendering:-webkit-optimize-contrast"}).attr("width",b).attr("height",c),canvg(d[0],F(a).html()),d[0].toDataURL("image/png")}},g.Column=function(){function a(a){var b,c;for(b in a)c=a[b],this[b]=c;F(this.el).css("height",this.height)}return a.name="Column",a.prototype.isStacked=!1,a.prototype.colorbrewer=4,a.prototype.padding={barValue:2,axisLabels:5,barPadding:.05},a.prototype.ticks={count:10},a.prototype.description={triangle:{degrees:30,sideA:.5,sideB:.866025}},a.prototype.series={},a.prototype.render=function(){var a,b,c,d,e,f,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_,ab,bb,cb=this;t=this.height,J=this.width,F(this.el).empty(),f=h.select(this.el[0]).append("svg:svg").attr("class","canvas"),this.useWholeNumbers=!0,this.maxValue=-Infinity;if(this.isStacked){R=this.data;for(M=0,P=R.length;M<P;M++){r=R[M],s=0,S=r.data;for(v in S)E=S[v],parseInt(E)!==E&&(this.useWholeNumbers=!1),s+=E;s>this.maxValue&&(this.maxValue=s)}}else{U=this.data;for(N=0,Q=U.length;N<Q;N++){r=U[N],V=r.data;for(v in V)E=V[v],parseInt(E)!==E&&(this.useWholeNumbers=!1),E>this.maxValue&&(this.maxValue=E)}}this.axis!=null&&(w=f.append("svg:g").attr("class","labels"),this.axis.horizontal!=null&&(A=w.append("svg:text").attr("class","horizontal").attr("text-anchor","middle").attr("x",J/2).attr("y",t-this.padding.axisLabels).text(this.axis.horizontal),t=t-A.node().getBBox().height-this.padding.axisLabels,g.expliticize(A)),this.axis.vertical!=null&&(A=w.append("svg:text").attr("class","vertical").attr("text-anchor","middle").attr("x",0).attr("y",t/2).text(this.axis.vertical),H=A.node().getBBox().height,A.attr("transform","rotate(-90 "+H+" "+t/2+")"),J=J-H-this.padding.axisLabels,g.expliticize(A))),n=f.append("svg:g").attr("class","descriptions"),this.description.maxWidth=-Infinity,this.description.totalWidth=0,m=0,W=this.data;for(u in W)r=W[u],p=n.append("svg:g").attr("class","g"+u),A=p.append("svg:text").attr("class","text").attr("text-anchor","end").text(r.description),B=A.node().getComputedTextLength(),B>this.description.maxWidth&&(this.description.maxWidth=B),this.description.totalWidth=this.description.totalWidth+B,g.expliticize(A),p.append("svg:title").text(r.description),m===0&&(m=A.node().getBBox().height);t-=m,q=f.append("svg:g").attr("class","grid"),o={},o.ticks=function(){var a,b,c,d,e;d=h.Scale.linear().setDomain([0,cb.maxValue]).getTicks(cb.ticks.count),e=[];for(b=0,c=d.length;b<c;b++)a=d[b],(parseInt(a)===a||!cb.useWholeNumbers)&&e.push(a);return e}(),this.ticks.maxWidth=-Infinity,X=o.ticks;for(u in X)C=X[u],z=q.append("svg:g").attr("class","t"+u),A=z.append("svg:text").attr("class","tick").attr("text-anchor","begin").attr("x",0).text(C),B=A.node().getComputedTextLength(),B>this.ticks.maxWidth&&(this.ticks.maxWidth=B),g.expliticize(A);J-=this.ticks.maxWidth,o.x=h.Scale.ordinal().setDomain(function(){bb=[];for(var a=0,b=this.data.length;0<=b?a<b:a>b;0<=b?a++:a--)bb.push(a);return bb}.apply(this)).setRangeBands([0,J],this.padding.barPadding),this.description.maxWidth>o.x.getRangeBand()&&(t-=this.description.maxWidth*this.description.triangle.sideA),o.y=h.Scale.linear().setDomain([0,this.maxValue]).setRange([0,t]),o.color=h.Scale.linear().setDomain([0,this.maxValue]).setRange([0,this.colorbrewer-1],!0),Z=o.ticks;for(u in Z)C=Z[u],z=q.select(".t"+u),x=z.append("svg:line").attr("class","line").attr("x1",this.ticks.maxWidth).attr("x2",J+this.ticks.maxWidth),g.expliticize(x),z.attr("transform","translate(0,"+(t-o.y(C))+")");i=f.append("svg:g").attr("class","chart"),e=i.append("svg:g").attr("class","bars"),G=i.append("svg:g").attr("class","values"),_=this.data;for(u in _){r=_[u],p=e.append("svg:g").attr("class","g"+u),d=o.x.getRangeBand(),this.isStacked||(d/=r.data.length),!this.isStacked&&r.data.length===2&&function(){var a;return a=cb.ticks.maxWidth+o.x(u)+d,x=p.append("svg:line").attr("class","line dashed").attr("style","stroke-dasharray: 10, 5;").attr("x1",a).attr("x2",a).attr("y1",0).attr("y2",t)}(),L=t,ab=r.data;for(y in ab){E=ab[y],b=o.y(E);if(!b&&this.isStacked)continue;K=o.x(u)+this.ticks.maxWidth,this.isStacked||(K+=y*d),this.isStacked||(L=t),L-=b,j=o.color(E).toFixed(0),a=p.append("svg:rect").attr("class","bar s"+y+" q"+j+"-"+this.colorbrewer).attr("x",K).attr("y",L).attr("width",d).attr("height",b),a.attr("opacity",1),g.expliticize(a),I=G.append("svg:g").attr("class","g"+u+" s"+y+" q"+j+"-"+this.colorbrewer),A=I.append("svg:text").attr("x",K+d/2).attr("text-anchor","middle").text(E),this.isStacked?(D=L+A.node().getBBox().height+this.padding.barValue,A.attr("y",D),A.node().getComputedTextLength()>d?A.attr("class","value on beyond"):A.attr("class","value on")):(D=L-this.padding.barValue,c=A.node().getBBox().height,D<c?(A.attr("y",D+c),A.node().getComputedTextLength()>d?A.attr("class","value on beyond"):A.attr("class","value on")):(A.attr("y",D),A.attr("class","value above"))),g.expliticize(A),I.append("svg:title").text(E),this.onclick!=null&&function(a,b,c,d){return a.on("click",function(){return cb.onclick(b.description,c,d)})}(a,r,y,E)}p.append("svg:title").text(r.description),l=n.select(".g"+u),k=l.select("text");if(this.description.maxWidth>d){k.attr("transform","rotate(-"+this.description.triangle.degrees+" 0 0)"),K+=d;while(k.node().getComputedTextLength()*this.description.triangle.sideB>K)k.text(k.text().replace("...","").split("").reverse().slice(1).reverse().join("")+"...")}else K=K+d-.5*d*r.data.length,k.attr("text-anchor","middle");l.attr("transform","translate("+K+","+(t+m)+")")}if(((T=this.axis)!=null?T.vertical:void 0)!=null)return w.select(".vertical").attr("transform","rotate(-90 "+H+" "+t/2+")").attr("y",t/2),q.attr("transform","translate("+(H+this.padding.axisLabels)+", 0)"),i.attr("transform","translate("+(H+this.padding.axisLabels)+", 0)"),n.attr("transform","translate("+(H+this.padding.axisLabels)+", 0)")},a.prototype.hideSeries=function(a){return h.select(this.el[0]).selectAll(".s"+a).attr("fill-opacity",.1)},a.prototype.showSeries=function(a){return h.select(this.el[0]).selectAll(".s"+a).attr("fill-opacity",1)},a.prototype.toPNG=function(){return g.toPNG(this.el,this.width,this.height)},a}(),g.Legend=function(){function a(a){var b,c;for(b in a)c=a[b],this[b]=c}return a.name="Legend",a.prototype.render=function(){var a,b,c,d,e,f=this;F(this.el).empty(),F(this.el).append(c=F("<ul/>")),d=this.series,e=[];for(a in d)b=d[a],e.push(function(a,b){return c.append(F("<li/>",{"class":"s"+a,html:b,click:function(b){return f.clickAction(b.target,a)}}))}(a,b));return e},a.prototype.clickAction=function(a,b){return F(a).toggleClass("disabled"),F(a).hasClass("disabled")?this.chart.hideSeries(b):this.chart.showSeries(b)},a}(),g.Settings=function(){function a(a){var b,c;for(b in a)c=a[b],this[b]=c}return a.name="Settings",a.prototype.render=function(){var a,b=this;return F(this.el).empty(),a=F(this.el).append(F("<a/>",{"class":"btn btn-mini stacked "+(this.isStacked?"active":""),text:this.isStacked?"Unstack":"Stack",click:function(a){return F(a.target).toggleClass("active"),F(a.target).hasClass("active")?(b.chart.isStacked=!0,F(a.target).text("Unstack")):(b.chart.isStacked=!1,F(a.target).text("Stack")),b.legend.render(),b.chart.render()}})),F(this.el).append(F("<a/>",{"class":"btn btn-mini png",text:"Save as a PNG",click:function(a){return C(a.target,'<img src="'+b.chart.toPNG()+'"/>')}}))},a}(),"bind"in Function.prototype||(Function.prototype.bind=function(a){var b,c;return c=this,arguments.length<=1?function(){return c.apply(a,arguments)}:(b=Array.prototype.slice.call(arguments,1),function(){return c.apply(a,arguments.length===0?b:b.concat(Array.prototype.slice.call(arguments)))})}),"trim"in String.prototype||(String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}),"indexOf"in Array.prototype||(Array.prototype.indexOf=function(a,b){var c;b===undefined&&(b=0),b<0&&(b+=this.length),b<0&&(b=0),c=this.length;while(b<c){if(b in this&&this[b]===a)return b;b++}return-1}),"lastIndexOf"in Array.prototype||(Array.prototype.lastIndexOf=function(a,b){b===undefined&&(b=this.length-1),b<0&&(b+=this.length),b>this.length-1&&(b=this.length-1),b++;while(b-->0)if(b in this&&this[b]===a)return b;return-1}),"forEach"in Array.prototype||(Array.prototype.forEach=function(a,b){var c,d,e;c=0,d=this.length,e=[];while(c<d)c in this&&a.call(b,this[c],c,this),e.push(c++);return e}),"map"in Array.prototype||(Array.prototype.map=function(a,b){var c,d,e;e=new Array(this.length),c=0,d=this.length;while(c<d)c in this&&(e[c]=a.call(b,this[c],c,this)),c++;return e}),"filter"in Array.prototype||(Array.prototype.filter=function(a,b){var c,d,e,f;e=[],f=void 0,c=0,d=this.length;while(c<d)c in this&&a.call(b,f=this[c],c,this)&&e.push(f),c++;return e}),"every"in Array.prototype||(Array.prototype.every=function(a,b){var c,d;c=0,d=this.length;while(c<d){if(c in this&&!a.call(b,this[c],c,this))return!1;c++}return!0}),"some"in Array.prototype||(Array.prototype.some=function(a,b){var c,d;c=0,d=this.length;while(c<d){if(c in this&&a.call(b,this[c],c,this))return!0;c++}return!1});var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;h={},h.Scale={},i={},w=[],i.selection=function(){return x},i.selection.prototype=w,s=function(a,b){return b.querySelector(a)},t=function(a,b){return b.querySelectorAll(a)},y=function(a){return function(){return s(a,this)}},z=function(a){return function(){return t(a,this)}},w.select=function(a){var b,c,d,e,f,g,h,i,j;i=[],h=void 0,j=void 0,b=void 0,g=void 0,typeof a!="function"&&(a=y(a)),d=-1,e=this.length;while(++d<e){i.push(h=[]),h.parentNode=(b=this[d]).parentNode,c=-1,f=b.length;while(++c<f)(g=b[c])?(h.push(j=a.call(g,g.__data__,c)),j&&"__data__"in g&&(j.__data__=g.__data__)):h.push(null)}return v(i)},w.selectAll=function(a){var b,c,d,e,f,g,h,i;i=[],h=void 0,g=void 0,typeof a!="function"&&(a=z(a)),d=-1,e=this.length;while(++d<e){b=this[d],c=-1,f=b.length;while(++c<f)if(g=b[c])i.push(h=j(a.call(g,g.__data__,c))),h.parentNode=g}return v(i)},w.append=function(a){var b,c;return b=function(){return this.appendChild(document.createElementNS(this.namespaceURI,a))},c=function(){return this.appendChild(document.createElementNS(a.space,a.local))},a=i.ns.qualify(a),this.select(a.local?c:b)},r={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml"},i.ns={prefix:r,qualify:function(a){var b,c;return b=a.indexOf(":"),c=a,b>=0&&(c=a.substring(0,b),a=a.substring(b+1)),r.hasOwnProperty(c)?{space:r[c],local:a}:a}},w.attr=function(a,b){var c,d,e,f,g,h,j,k;return g=function(){return this.removeAttribute(a)},h=function(){return this.removeAttributeNS(a.space,a.local)},c=function(){return this.setAttribute(a,b)},d=function(){return this.setAttributeNS(a.space,a.local,b)},e=function(){var c;return c=b.apply(this,arguments),c==null?this.removeAttribute(a):this.setAttribute(a,c)},f=function(){var c;return c=b.apply(this,arguments),c==null?this.removeAttributeNS(a.space,a.local):this.setAttributeNS(a.space,a.local,c)},a=i.ns.qualify(a),arguments.length<2?(j=this.node(),a.local?j.getAttributeNS(a.space,a.local):j.getAttribute(a)):(k=function(){return b==null?a.local?h:g:typeof b=="function"?a.local?f:e:a.local?d:c}(),this.each(k))},w.each=function(a){var b,c,d,e,f,g;d=-1,e=this.length;while(++d<e){b=this[d],c=-1,f=b.length;while(++c<f)g=b[c],g&&a.call(g,g.__data__,c,d)}return this},w.text=function(a){var b;return arguments.length<1?this.node().textContent:(b=function(){return typeof a=="function"?function(){var b;return b=a.apply(this,arguments),this.textContent=b==null?"":b}:a==null?function(){return this.textContent=""}:function(){return this.textContent=a}}(),this.each(b))},w.node=function(a){var b,c,d,e,f,g;d=0,e=this.length;while(d<e){b=this[d],c=0,f=b.length;while(c<f){g=b[c];if(g)return g;c++}d++}return null},o=function(){return i.event.stopPropagation(),i.event.preventDefault()},q=function(){var a,b;a=i.event,b=void 0;while(b=a.sourceEvent)a=b;return a},m=function(){},m.prototype.on=function(a,b){var c,d;return c=a.indexOf("."),d="",c>0&&(d=a.substring(c+1),a=a.substring(0,c)),arguments.length<2?this[a].on(d):this[a].on(d,b)},n=function(a){var b,c,d;return b=function(){var b,c,e,f;return f=d,b=-1,e=f.length,c=void 0,function(){var a;a=[];while(++b<e)a.push(c=f[b].on);return a}()&&c.apply(this,arguments),a},d=[],c=new d3_Map,b.on=function(b,e){var f,g;return g=c.get(b),f=void 0,arguments.length<2?g&&g.on:(g&&(g.on=null,d=d.slice(0,f=d.indexOf(g)).concat(d.slice(f+1)),c.remove(b)),e&&d.push(c.set(b,{on:e})),a)},b},p=function(a){var b,c,d;b=new m,c=0,d=arguments.length;while(++c<d)b[arguments[c]]=n(b);return b.of=function(c,d){return function(e){var f;try{return f=e.sourceEvent=i.event,e.target=a,i.event=e,b[e.type].apply(c,d)}finally{i.event=f}}},b},i.event=null,w.on=function(a,b,c){var d,e;return arguments.length<3&&(c=!1),e="__on"+a,d=a.indexOf("."),d>0&&(a=a.substring(0,d)),arguments.length<2?(d=this.node()[e])&&d._:this.each(function(d,f){var g,h,j;g=function(a){var c;c=i.event,i.event=a;try{return b.call(h,h.__data__,f)}finally{i.event=c}},h=this,j=h[e],j&&(h.removeEventListener(a,j,j.$),delete h[e]);if(b)return h.addEventListener(a,h[e]=g,g.$=c),g._=b})},v=function(a){return a.__proto__=w,a},x=v([[document]]),u=document.documentElement,x[0].parentNode=u,l=function(a){return Array.prototype.slice.call(a)},k=function(a){var b,c,d;c=-1,d=a.length,b=[];while(++c<d)b.push(a[c]);return b};try{j(document.documentElement.childNodes)[0].nodeType}catch(A){j=k}j=l,h.selectAll=function(a){return typeof a=="string"?x.selectAll(a):v([j(a)])},h.select=function(a){return typeof a=="string"?x.select(a):v([[a]])},h.Scale.ordinal=function(){return function(){var a,b;return a={},b=function(b){if(a.range==null)throw new Error("Mynd.Scale.ordinal: you need to set input range first");return a.range[b]},b.setDomain=function(c){var d,e,f,g,h,i;c==null&&(c=[]),d={};for(h=0,i=c.length;h<i;h++)e=c[h],d[e]=e;return a.domain=function(){var a;a=[];for(f in d)g=d[f],a.push(g);return a}(),b},b.setRangeBands=function(c,d){var e,f,g,h,i,j,k,l,m;d==null&&(d=0);if(a.domain==null)throw new Error("Mynd.Scale.ordinal: you need to set input domain first");return g=c[0],i=c[1],f=c[1]<c[0],f&&(k=[g,i],i=k[0],g=k[1]),h=(i-g)/(a.domain.length+d),e=function(){m=[];for(var b=0,c=a.domain.length;0<=c?b<c:b>c;0<=c?b++:b--)m.push(b);return m}.apply(this).map(function(a){return g+h*d+h*a}),f&&e.reverse(),a.range=e,a.rangeBand=h*(1-d),b},b.getRangeBand=function(){return a.rangeBand},b.setDomain()}()},h.Scale.linear=function(){return function(){var a,b,c,d,e;return b={},a=function(a,b){return function(c){return(c-a)*1/(b-a)}},c=function(a,b,c){return c?function(c){return Math.round(a+b*c)}:function(c){return a+b*c}},e=function(b,d,e){return function(f){return c(d[0],d[1],e)(a(b[0],b[1])(f))}},d=function(a){if(b.output==null){if(b.domain==null||b.range==null)throw new Error("Mynd.Scale.linear: you need to set both input domain and range");b.output=e(b.domain,b.range,b.round)}return b.output(a)},d.setDomain=function(a){return b.domain=a,d},d.setRange=function(a,c){return c==null&&(c=!1),b.range=a,b.round=c,d},d.getTicks=function(a){var c,d,e,f,g,h,i,j;if(b.domain==null)throw new Error("Mynd.Scale.linear: you need to set input domain first");e=b.domain[0],g=b.domain[1],c=b.domain[1]<b.domain[0],c&&(j=[e,g],g=j[0],e=j[1]),d=g-e,f=Math.pow(10,Math.floor(Math.log(d/a)/Math.LN10)),i=a/d*f,i<=.15?f*=10:i<=.35?f*=5:i<=.75&&(f*=2),h=[],i=Math.ceil(e/f)*f;while(i<=Math.floor(g/f)*f+f*.5)h.push(i),i+=f;return h},d}()};var B,C,D=function(a,b){return function(){return a.apply(b,arguments)}};B=function(){function a(a,b,c){var d;c==null&&(c="widget.tsv"),this.destroy=D(this.destroy,this),d=new(window.WebKitBlobBuilder||window.MozBlobBuilder||window.BlobBuilder),d.append(b),a.attr("download",c),(this.href=this.url.createObjectURL(d.getBlob(""+this.mime+";charset="+this.charset)))&&a.attr("href",this.href),a.attr("data-downloadurl",[this.mime,c,this.href].join(":"))}return a.name="Exporter",a.prototype.mime="text/plain",a.prototype.charset="UTF-8",a.prototype.url=window.webkitURL||window.URL,a.prototype.destroy=function(){return this.url.revokeObjectURL(this.href)},a}(),C=function(){function a(a,b){var c;c=window.open(),c==null||typeof c=="undefined"?a.after(this.msg=F("<span/>",{style:"margin-left:5px","class":"label label-inverse",text:"Please enable popups"})):(c.document.open(),c.document.write(b),c.document.close())}return a.name="PlainExporter",a.prototype.destroy=function(){var a;return(a=this.msg)!=null?a.fadeOut():void 0},a}();var E;E=function(a){var d,e=function(a,b){return function(){return a.apply(b,arguments)}};d=function(){function a(){this.error=e(this.error,this),this.validateType=e(this.validateType,this),F(this.el).html(F("<div/>",{"class":"inner",style:"height:572px;overflow:hidden;position:relative"})),this.el=""+this.el+" div.inner",this.imService=new intermine.Service({root:this.service,token:this.token})}return a.name="InterMineWidget",a.prototype.template=function(a,c){var d;return c==null&&(c={}),typeof b[d=""+a+".eco"]=="function"?b[d](c):void 0},a.prototype.validateType=function(a,b){var d,e,f,g;d=[];for(e in a)g=a[e],(f=(typeof b[e]=="function"?new b[e](g):void 0)||(f=new c.isUndefined))&&!f.is()&&d.push(this.template("invalidjsonkey",{key:e,actual:f.is(),expected:new String(f)}));if(d.length)return this.error(d,"JSONResponse")},a.prototype.error=function(a,b){a==null&&(a={title:"Error",text:"Generic error"}),a.name=this.name||this.id;switch(b){case"AJAXTransport":a.title="AJAX Request Failed";break;case"JSONResponse":a.title="Invalid JSON Response",a.text="<ol>"+a.join("")+"</ol>"}throw F(this.el).html(this.template("error",a)),new Error(b)},a}();var h,e=function(a,b){return function(){return a.apply(b,arguments)}},i={}.hasOwnProperty,j=function(a,b){function d(){this.constructor=a}for(var c in b)i.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};h=function(a){function b(a,c,d,g,h,i){this.service=a,this.token=c,this.id=d,this.bagName=g,this.el=h,i==null&&(i={}),this.render=e(this.render,this),this.widgetOptions=f(i,this.widgetOptions),b.__super__.constructor.call(this),this.render()}return j(b,a),b.name="ChartWidget",b.prototype.widgetOptions={title:!0,description:!0,matchCb:function(a,b){return typeof console!="undefined"&&console!==null?console.log(a,b):void 0},resultsCb:function(a){return typeof console!="undefined"&&console!==null?console.log(a):void 0},listCb:function(a){return typeof console!="undefined"&&console!==null?console.log(a):void 0}},b.prototype.formOptions={},b.prototype.spec={response:{chartType:c.isString,description:c.isString,error:c.isNull,list:c.isString,notAnalysed:c.isInteger,pathQuery:c.isString,requestedAt:c.isString,results:c.isArray,seriesLabels:c.isString,seriesValues:c.isString,statusCode:c.isHTTPSuccess,title:c.isString,type:c.isString,wasSuccessful:c.isBoolean,filters:c.isString,filterLabel:c.isString,filterSelectedValue:c.isString,simplePathQuery:c.isString,domainLabel:c.isString,rangeLabel:c.isString}},b.prototype.render=function(){var a,b,c,d,e,f,g=this;c=window.setTimeout(function(){return F(g.el).append(g.loading=F(g.template("loading")))},400),(e=this.view)!=null&&e.undelegateEvents(),a={widget:this.id,list:this.bagName,token:this.token},f=this.formOptions;for(b in f)d=f[b],b!=="errorCorrection"&&b!=="pValue"&&(a.filter=d);return F.ajax({url:""+this.service+"list/chart",dataType:"jsonp",data:a,success:function(a){var b;window.clearTimeout(c),(b=g.loading)!=null&&b.remove(),g.validateType(a,g.spec.response);if(a.wasSuccessful)return g.name=a.title,g.view=new w({widget:g,el:g.el,template:g.template,response:a,form:{options:g.formOptions},options:g.widgetOptions})},error:function(a,b,d){return clearTimeout(c),g.error({text:""+g.service+"list/chart"},"AJAXTransport")}})},b}(d);var k,e=function(a,b){return function(){return a.apply(b,arguments)}},i={}.hasOwnProperty,j=function(a,b){function d(){this.constructor=a}for(var c in b)i.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};k=function(a){function b(a,c,d,g,h,i){this.service=a,this.token=c,this.id=d,this.bagName=g,this.el=h,i==null&&(i={}),this.render=e(this.render,this),this.widgetOptions=f(i,this.widgetOptions),b.__super__.constructor.call(this),this.render()}return j(b,a),b.name="TableWidget",b.prototype.widgetOptions={title:!0,description:!0,matchCb:function(a,b){return typeof console!="undefined"&&console!==null?console.log(a,b):void 0},resultsCb:function(a){return typeof console!="undefined"&&console!==null?console.log(a):void 0},listCb:function(a){return typeof console!="undefined"&&console!==null?console.log(a):void 0}},b.prototype.spec={response:{columnTitle:c.isString,title:c.isString,description:c.isString,pathQuery:c.isString,columns:c.isString,pathConstraint:c.isString,requestedAt:c.isString,list:c.isString,type:c.isString,notAnalysed:c.isInteger,results:c.isArray,wasSuccessful:c.isBoolean,error:c.isNull,statusCode:c.isHTTPSuccess}},b.prototype.render=function(){var a,b,c,d=this;return b=window.setTimeout(function(){return F(d.el).append(d.loading=F(d.template("loading")))},400),(c=this.view)!=null&&c.undelegateEvents(),a={widget:this.id,list:this.bagName,token:this.token},F.ajax({url:""+this.service+"list/table",dataType:"jsonp",data:a,success:function(a){var c;window.clearTimeout(b),(c=d.loading)!=null&&c.remove(),d.validateType(a,d.spec.response);if(a.wasSuccessful)return d.name=a.title,d.view=new u({widget:d,el:d.el,template:d.template,response:a,options:d.widgetOptions})},error:function(a,c,e){return clearTimeout(b),d.error({text:""+d.service+"list/table"},"AJAXTransport")}})},b}(d);var l,e=function(a,b){return function(){return a.apply(b,arguments)}},i={}.hasOwnProperty,j=function(a,b){function d(){this.constructor=a}for(var c in b)i.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};l=function(a){function b(a,c,d,g,h,i){this.service=a,this.token=c,this.id=d,this.bagName=g,this.el=h,i==null&&(i={}),this.render=e(this.render,this),this.widgetOptions=f(i,this.widgetOptions),this.formOptions={errorCorrection:"Holm-Bonferroni",pValue:"0.05"},b.__super__.constructor.call(this),this.render()}return j(b,a),b.name="EnrichmentWidget",b.prototype.widgetOptions={title:!0,description:!0,matchCb:function(a,b){return typeof console!="undefined"&&console!==null?console.log(a,b):void 0},resultsCb:function(a){return typeof console!="undefined"&&console!==null?console.log(a):void 0},listCb:function(a){return typeof console!="undefined"&&console!==null?console.log(a):void 0}},b.prototype.errorCorrections=["Holm-Bonferroni","Benjamini Hochberg","Bonferroni","None"],b.prototype.pValues=["0.05","0.10","1.00"],b.prototype.spec={response:{title:c.isString,description:c.isString,pathQuery:c.isJSON,pathConstraint:c.isString,error:c.isNull,list:c.isString,notAnalysed:c.isInteger,requestedAt:c.isString,results:c.isArray,label:c.isString,statusCode:c.isHTTPSuccess,type:c.isString,wasSuccessful:c.isBoolean,filters:c.isString,filterLabel:c.isString,filterSelectedValue:c.isString,externalLink:c.isString,pathQueryForMatches:c.isString}},b.prototype.render=function(){var a,b,c,d,e,f,g=this;c=window.setTimeout(function(){return F(g.el).append(g.loading=F(g.template("loading")))},400),(e=this.view)!=null&&e.undelegateEvents(),a={widget:this.id,list:this.bagName,correction:this.formOptions.errorCorrection,maxp:this.formOptions.pValue,token:this.token},f=this.formOptions;for(b in f)d=f[b],b!=="errorCorrection"&&b!=="pValue"&&(a.filter=d);return F.ajax({url:""+this.service+"list/enrichment",dataType:"jsonp",data:a,success:function(a){var b;window.clearTimeout(c),(b=g.loading)!=null&&b.remove(),g.validateType(a,g.spec.response);if(a.wasSuccessful)return g.name=a.title,g.view=new z({widget:g,el:g.el,template:g.template,response:a,form:{options:g.formOptions,pValues:g.pValues,errorCorrections:g.errorCorrections},options:g.widgetOptions})},error:function(a,b,d){return clearTimeout(c),g.error({text:""+g.service+"list/enrichment"},"AJAXTransport")}})},b}(d);var m,n,o,p,q,r,e=function(a,b){return function(){return a.apply(b,arguments)}},i={}.hasOwnProperty,j=function(a,b){function d(){this.constructor=a}for(var c in b)i.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};n=function(a){function b(){return this.toggleSelected=e(this.toggleSelected,this),this.validate=e(this.validate,this),b.__super__.constructor.apply(this,arguments)}return j(b,a),b.name="CoreModel",b.prototype.defaults={selected:!1},b.prototype.initialize=function(a,b){return this.widget=b,this.validate(a)},b.prototype.validate=function(a){return this.widget.validateType(a,this.spec)},b.prototype.toggleSelected=function(){return this.set({selected:!this.get("selected")})},b}(a.Model),m=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b.name="CoreCollection",b.prototype.model=n,b.prototype.selected=function(){return this.filter(function(a){return a.get("selected")})},b.prototype.toggleSelected=function(){var a,b,c,d,e,f,g,h,i;if(this.models.length-this.selected().length){f=this.models,h=[];for(b=0,d=f.length;b<d;b++)a=f[b],h.push(a.set({selected:!0},{silent:!0}));return h}g=this.models,i=[];for(c=0,e=g.length;c<e;c++)a=g[c],i.push(a.set({selected:!1},{silent:!0}));return i},b}(a.Collection),p=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b.name="EnrichmentRow",b.prototype.spec={description:c.isString,identifier:c.isString,matches:c.isInteger,"p-value":c.isInteger,selected:c.isBoolean,externalLink:c.isString},b}(n),o=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b.name="EnrichmentResults",b.prototype.model=p,b}(m),r=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b.name="TableRow",b.prototype.spec={matches:c.isInteger,identifier:c.isInteger,descriptions:c.isArray,selected:c.isBoolean},b}(n),q=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b.name="TableResults",b.prototype.model=r,b}(m);var s,e=function(a,b){return function(){return a.apply(b,arguments)}},i={}.hasOwnProperty,j=function(a,b){function d(){this.constructor=a}for(var c in b)i.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};s=function(a){function b(){return this.toggleMatchesAction=e(this.toggleMatchesAction,this),this.selectAction=e(this.selectAction,this),this.render=e(this.render,this),b.__super__.constructor.apply(this,arguments)}return j(b,a),b.name="EnrichmentRowView",b.prototype.tagName="tr",b.prototype.events={"click td.check input":"selectAction","click td.matches a.count":"toggleMatchesAction"},b.prototype.initialize=function(a){var b,c;for(b in a)c=a[b],this[b]=c;return this.model.bind("change",this.render),this.render()},b.prototype.render=function(){return F(this.el).html(this.template("enrichment.row",{row:this.model.toJSON()})),this},b.prototype.selectAction=function(){return this.model.toggleSelected()},b.prototype.toggleMatchesAction=function(){return this.popoverView==null?F(this.el).find("td.matches a.count").after((this.popoverView=new x({matches:this.model.get("matches"),identifiers:[this.model.get("identifier")],description:this.model.get("description"),template:this.template,matchCb:this.callbacks.matchCb,resultsCb:this.callbacks.resultsCb,listCb:this.callbacks.listCb,response:this.response,imService:this.imService})).el):this.popoverView.toggle()},b}(a.View);var t,e=function(a,b){return function(){return a.apply(b,arguments)}},i={}.hasOwnProperty,j=function(a,b){function d(){this.constructor=a}for(var c in b)i.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};t=function(a){function b(){return this.selectAction=e(this.selectAction,this),this.render=e(this.render,this),b.__super__.constructor.apply(this,arguments)}return j(b,a),b.name="TableRowView",b.prototype.tagName="tr",b.prototype.events={"click td.check input":"selectAction"},b.prototype.initialize=function(a){var b,c;for(b in a)c=a[b],this[b]=c;return this.model.bind("change",this.render),this.render()},b.prototype.render=function(){return F(this.el).html(this.template("table.row",{row:this.model.toJSON()})),this},b.prototype.selectAction=function(){return this.model.toggleSelected()},b}(a.View);var u,e=function(a,b){return function(){return a.apply(b,arguments)}},i={}.hasOwnProperty,j=function(a,b){function d(){this.constructor=a}for(var c in b)i.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};u=function(a){function b(){return this.viewAction=e(this.viewAction,this),this.exportAction=e(this.exportAction,this),this.selectAllAction=e(this.selectAllAction,this),this.renderTableBody=e(this.renderTableBody,this),this.renderTable=e(this.renderTable,this),this.renderToolbar=e(this.renderToolbar,this),b.__super__.constructor.apply(this,arguments)}return j(b,a),b.name="TableView",b.prototype.events={"click div.actions a.view":"viewAction","click div.actions a.export":"exportAction","click div.content input.check":"selectAllAction"},b.prototype.initialize=function(a){var b,c;for(b in a)c=a[b],this[b]=c;return this.collection=new q,this.collection.bind("change",this.renderToolbar),this.render()},b.prototype.render=function(){return F(this.el).html(this.template("table",{title:this.options.title?this.response.title:"",description:this.options.description?this.response.description:"",notAnalysed:this.response.notAnalysed})),this.response.results.length>0?(this.renderToolbar(),this.renderTable()):F(this.el).find("div.content").html(F(this.template("noresults"))),this},b.prototype.renderToolbar=function(){return F(this.el).find("div.actions").html(F(this.template("actions",{disabled:this.collection.selected().length===0})))},b.prototype.renderTable=function(){var a,b,c,d,e,f,g=this;F(this.el).find("div.content").html(F(this.template("table.table",{columns:this.response.columns.split(",")}))),c=F(this.el).find("div.content table"),d=function(a){var b;return b=new r(g.response.results[a],g.widget),g.collection.add(b)};for(b=e=0,f=this.response.results.length;0<=f?e<f:e>f;b=0<=f?++e:--e)d(b);return this.renderTableBody(c),a=F(this.el).height()-F(this.el).find("div.header").height()-F(this.el).find("div.content div.head").height(),F(this.el).find("div.content div.wrapper").css("height",""+a+"px"),F(this.el).find("div.content div.head").css("width",F(this.el).find("div.content table").width()+"px"),c.find("thead th").each(function(a,b){return F(g.el).find("div.content div.head div:eq("+a+")").width(F(b).width())}),c.css({"margin-top":"-"+c.find("thead").height()+"px"})},b.prototype.renderTableBody=function(a){var b,c,d,e,f;b=document.createDocumentFragment(),f=this.collection.models;for(d=0,e=f.length;d<e;d++)c=f[d],b.appendChild((new t({model:c,template:this.template,response:this.response})).el);return a.find("tbody").html(b)},b.prototype.selectAllAction=function(){return this.collection.toggleSelected(),this.renderToolbar(),this.renderTableBody(F(this.el).find("div.content table"))},b.prototype.exportAction=function(a){var b,c,d,e,f,g;d=[this.response.columns.replace(/,/g,"	")],g=this.collection.selected();for(e=0,f=g.length;e<f;e++)c=g[e],d.push(c.get("descriptions").join("	")+"	"+c.get("matches"));if(d.length)return b=new C(F(a.target),"<pre>"+d.join("\n")+"<pre>"),window.setTimeout(function(){return b.destroy()},5e3)},b.prototype.viewAction=function(){var a,b,c,d,e,f,g;a=[],c=[],f=this.collection.selected();for(d=0,e=f.length;d<e;d++)b=f[d],a.push(b.get("descriptions")[0]),c.push(b.get("identifier"));if(c.length)return(g=this.popoverView)!=null&&g.remove(),F(this.el).find("div.actions").after((this.popoverView=new v({identifiers:c,description:a.join(", "),template:this.template,matchCb:this.options.matchCb,resultsCb:this.options.resultsCb,listCb:this.options.listCb,pathQuery:this.response.pathQuery,pathConstraint:this.response.pathConstraint,imService:this.widget.imService,type:this.response.type})).el)},b}(a.View);var v,e=function(a,b){return function(){return a.apply(b,arguments)}},i={}.hasOwnProperty,j=function(a,b){function d(){this.constructor=a}for(var c in b)i.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};v=function(a){function b(){return this.close=e(this.close,this),this.listAction=e(this.listAction,this),this.resultsAction=e(this.resultsAction,this),this.matchAction=e(this.matchAction,this),this.renderValues=e(this.renderValues,this),this.render=e(this.render,this),b.__super__.constructor.apply(this,arguments)}return j(b,a),b.name="TablePopoverView",b.prototype.descriptionLimit=50,b.prototype.valuesLimit=5,b.prototype.events={"click a.match":"matchAction","click a.results":"resultsAction","click a.list":"listAction","click a.close":"close"},b.prototype.initialize=function(a){var b,c;for(b in a)c=a[b],this[b]=c;return this.render()},b.prototype.render=function(){var a,b=this;return F(this.el).css({position:"relative"}),F(this.el).html(this.template("popover",{description:this.description,descriptionLimit:this.descriptionLimit,style:"width:300px"})),this.pathQuery=JSON.parse(this.pathQuery),this.pathQuery.where.push({path:this.pathConstraint,op:"ONE OF",values:this.identifiers}),a=[],this.imService.query(this.pathQuery,function(c){return c.rows(function(c){var d,e,f;for(e=0,f=c.length;e<f;e++)d=c[e],a.push(function(a){var b,c,d;for(c=0,d=a.length;c<d;c++){b=a[c];if(b.length>0)return b}}(d));return b.renderValues(a)})}),this},b.prototype.renderValues=function(a){return F(this.el).find("div.values").html(this.template("popover.values",{values:a,type:this.type,valuesLimit:this.valuesLimit}))},b.prototype.matchAction=function(a){return this.matchCb(F(a.target).text(),this.type),a.preventDefault()},b.prototype.resultsAction=function(){return this.resultsCb(this.pathQuery)},b.prototype.listAction=function(){return this.listCb(this.pathQuery)},b.prototype.close=function(){return F(this.el).remove()},b}(a.View);var w,e=function(a,b){return function(){return a.apply(b,arguments)}},i={}.hasOwnProperty,j=function(a,b){function d(){this.constructor=a}for(var c in b)i.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};w=function(a){function b(){return this.formAction=e(this.formAction,this),this.barAction=e(this.barAction,this),b.__super__.constructor.apply(this,arguments)}return j(b,a),b.name="ChartView",b.prototype.events={"change div.form select":"formAction"},b.prototype.initialize=function(a){var b,c;for(b in a)c=a[b],this[b]=c;return this.render()},b.prototype.render=function(){var a,b,c,d,e,f,h,i;F(this.el).html(this.template("chart",{title:this.options.title?this.response.title:"",description:this.options.description?this.response.description:"",notAnalysed:this.response.notAnalysed})),this.response.filterLabel!=null&&F(this.el).find("div.form form").append(this.template("extra",{label:this.response.filterLabel,possible:this.response.filters.split(","),selected:this.response.filterSelectedValue}));if(this.response.results.length>1){b=[],i=this.response.results.slice(1);for(f=0,h=i.length;f<h;f++)e=i[f],b.push({description:e[0],data:[e[1],e[2]]});return a=new g.Column({el:F(this.el).find("div.content div.chart"),data:b,width:460,onclick:this.barAction,isStacked:this.response.chartType==="BarChart",axis:{horizontal:this.response.domainLabel,vertical:this.response.type+" Count"}}),c=new g.Legend({el:F(this.el).find("div.content div.legend"),chart:a,series:[this.response.results[0][1],this.response.results[0][2]]}),c.render(),d=new g.Settings({el:F(this.el).find("div.content div.settings"),chart:a,legend:c,isStacked:this.response.chartType==="BarChart"}),d.render(),a.height=F(this.widget.el).height()-F(this.widget.el).find("div.header").height()-F(this.widget.el).find("div.content div.legend").height()-F(this.widget.el).find("div.content div.settings").height(),a.render()}return F(this.el).find("div.content").html(F(this.template("noresults")))},b.prototype.barAction=function(a,b,c){var d,e,f,g,h;d="",f=this.response.pathQuery,e=this.response.simplePathQuery,d+=a,f=f.replace("%category",a),e=e.replace("%category",a),d+=" "+this.response.seriesLabels.split(",")[b],g=(h=this.response.seriesValues)!=null?h.split(",")[b]:void 0,f=f.replace("%series",g),e=f.replace("%series",g),f=typeof JSON!="undefined"&&JSON!==null?JSON.parse(f):void 0,e=typeof JSON!="undefined"&&JSON!==null?JSON.parse(e):void 0,this.barView!=null&&this.barView.close();if(d)return F(this.el).find("div.content").append((this.barView=new A({description:d,template:this.template,resultsPq:f,resultsCb:this.options.resultsCb,listCb:this.options.listCb,matchCb:this.options.matchCb,quickPq:e,imService:this.widget.imService,type:this.response.type})).el)},b.prototype.formAction=function(a){return this.widget.formOptions[F(a.target).attr("name")]=F(a.target[a.target.selectedIndex]).attr("value"),this.widget.render()},b}(a.View);var x,e=function(a,b){return function(){return a.apply(b,arguments)}},i={}.hasOwnProperty,j=function(a,b){function d(){this.constructor=a}for(var c in b)i.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a},y=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};x=function(a){function b(){return this.listAction=e(this.listAction,this),this.resultsAction=e(this.resultsAction,this),this.matchAction=e(this.matchAction,this),this.getPq=e(this.getPq,this),this.toggle=e(this.toggle,this),this.renderValues=e(this.renderValues,this),this.render=e(this.render,this),b.__super__.constructor.apply(this,arguments)}return j(b,a),b.name="EnrichmentPopoverView",b.prototype.descriptionLimit=50,b.prototype.valuesLimit=5,b.prototype.events={"click a.match":"matchAction","click a.results":"resultsAction","click a.list":"listAction","click a.close":"toggle"},b.prototype.initialize=function(a){var b,c;for(b in a)c=a[b],this[b]=c;return this.render()},b.prototype.render=function(){var a,b,c=this;return F(this.el).css({position:"relative"}),F(this.el).html(this.template("popover",{description:this.description,descriptionLimit:this.descriptionLimit,style:this.style||"width:300px;margin-left:-300px"})),a=typeof JSON!="undefined"&&JSON!==null?JSON.parse(this.response.pathQueryForMatches):void 0,a.where.push({path:this.response.pathConstraint,op:"ONE OF",values:this.identifiers}),b=[],this.imService.query(a,function(a){return a.rows(function(a){var d,e,f,g;for(f=0,g=a.length;f<g;f++)d=a[f],e=function(a){var b,c,d,e;e=a.reverse();for(c=0,d=e.length;c<d;c++){b=e[c];if(b.length>0)return b}}(d),y.call(b,e)<0&&b.push(e);return c.renderValues(b)})}),this},b.prototype.renderValues=function(a){return F(this.el).find("div.values").html(this.template("popover.values",{values:a,type:this.response.type,valuesLimit:this.valuesLimit}))},b.prototype.toggle=function(){return F(this.el).toggle()},b.prototype.getPq=function(){var a;return a=this.response.pathQuery,this.pq=JSON.parse(a),this.pq.where.push({path:this.response.pathConstraint,op:"ONE OF",values:this.identifiers})},b.prototype.matchAction=function(a){return this.matchCb(F(a.target).text(),this.response.type),a.preventDefault()},b.prototype.resultsAction=function(){return this.pq==null&&this.getPq(),this.resultsCb(this.pq)},b.prototype.listAction=function(){return this.pq==null&&this.getPq(),this.listCb(this.pq)},b}(a.View);var z,e=function(a,b){return function(){return a.apply(b,arguments)}},i={}.hasOwnProperty,j=function(a,b){function d(){this.constructor=a}for(var c in b)i.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};z=function(a){function b(){return this.viewAction=e(this.viewAction,this),this.exportAction=e(this.exportAction,this),this.selectAllAction=e(this.selectAllAction,this),this.formAction=e(this.formAction,this),this.renderTableBody=e(this.renderTableBody,this),this.renderTable=e(this.renderTable,this),this.renderToolbar=e(this.renderToolbar,this),b.__super__.constructor.apply(this,arguments)}return j(b,a),b.name="EnrichmentView",b.prototype.events={"click div.actions a.view":"viewAction","click div.actions a.export":"exportAction","change div.form select":"formAction","click div.content input.check":"selectAllAction"},b.prototype.initialize=function(a){var b,c;for(b in a)c=a[b],this[b]=c;return this.collection=new o,this.collection.bind("change",this.renderToolbar),this.render()},b.prototype.render=function(){return F(this.el).html(this.template("enrichment",{title:this.options.title?this.response.title:"",description:this.options.description?this.response.description:"",notAnalysed:this.response.notAnalysed})),F(this.el).find("div.form").html(this.template("enrichment.form",{options:this.form.options,pValues:this.form.pValues,errorCorrections:this.form.errorCorrections})),this.response.filterLabel!=null&&F(this.el).find("div.form form").append(this.template("extra",{label:this.response.filterLabel,possible:this.response.filters.split(","),selected:this.response.filterSelectedValue})),this.response.results.length>0?(this.renderToolbar(),this.renderTable()):F(this.el).find("div.content").html(F(this.template("noresults"))),this},b.prototype.renderToolbar=function(){return F(this.el).find("div.actions").html(F(this.template("actions",{disabled:this.collection.selected().length===0})))},b.prototype.renderTable=function(){var a,b,c,d,e,f,g=this;F(this.el).find("div.content").html(F(this.template("enrichment.table",{label:this.response.label}))),c=F(this.el).find("div.content table"),d=function(a){var b,c;return b=g.response.results[a],g.response.externalLink&&(b.externalLink=g.response.externalLink+b.identifier),c=new p(b,g.widget),g.collection.add(c)};for(b=e=0,f=this.response.results.length;0<=f?e<f:e>f;b=0<=f?++e:--e)d(b);return this.renderTableBody(c),a=F(this.el).height()-F(this.el).find("div.header").height()-F(this.el).find("div.content div.head").height(),F(this.el).find("div.content div.wrapper").css("height",""+a+"px"),F(this.el).find("div.content div.head").css("width",F(this.el).find("div.content table").width()+"px"),c.find("thead th").each(function(a,b){return F(g.el).find("div.content div.head div:eq("+a+")").width(F(b).width())}),c.css({"margin-top":"-"+c.find("thead").height()+"px"})},b.prototype.renderTableBody=function(a){var b,c,d,e,f;b=document.createDocumentFragment(),f=this.collection.models;for(d=0,e=f.length;d<e;d++)c=f[d],b.appendChild((new s({model:c,template:this.template,type:this.response.type,callbacks:{matchCb:this.options.matchCb,resultsCb:this.options.resultsCb,listCb:this.options.listCb},response:this.response,imService:this.widget.imService})).el);return a.find("tbody").html(b)},b.prototype.formAction=function(a){return this.widget.formOptions[F(a.target).attr("name")]=F(a.target[a.target.selectedIndex]).attr("value"),this.widget.render()},b.prototype.selectAllAction=function(){return this.collection.toggleSelected(),this.renderToolbar(),this.renderTableBody(F(this.el).find("div.content table"))},b.prototype.exportAction=function(a){var b,c,d,e,f,g,h=this;d=[],g=this.collection.selected();for(e=0,f=g.length;e<f;e++)b=g[e],d.push(b.get("identifier"));return c=typeof JSON!="undefined"&&JSON!==null?JSON.parse(this.response.pathQueryForMatches):void 0,c.where.push({path:this.response.pathConstraint,op:"ONE OF",values:d}),this.widget.imService.query(c,function(b){return b.rows(function(b){var c,d,e,f,g,i,j,k,l,m;c={};for(i=0,k=b.length;i<k;i++)f=b[i],c[f[0]]==null&&(c[f[0]]=[]),c[f[0]].push(f[1]);g=[],m=h.collection.selected();for(j=0,l=m.length;j<l;j++)e=m[j],g.push([e.get("description"),e.get("p-value")].join("	")+"	"+c[e.get("identifier")].join(","));if(g.length)return d=new C(F(a.target),"<pre>"+g.join("\n")+"<pre>"),window.setTimeout(function(){return d.destroy()},5e3)})})},b.prototype.viewAction=function(){var a,b,c,d,e,f,g;a=[],c=[],f=this.collection.selected();for(d=0,e=f.length;d<e;d++)b=f[d],a.push(b.get("description")),c.push(b.get("identifier"));if(c.length)return(g=this.popoverView)!=null&&g.remove(),F(this.el).find("div.actions").after((this.popoverView=new x({identifiers:c,description:a.join(", "),template:this.template,style:"width:300px",matchCb:this.options.matchCb,resultsCb:this.options.resultsCb,listCb:this.options.listCb,response:this.response,imService:this.widget.imService})).el)},b}(a.View);var A,e=function(a,b){return function(){return a.apply(b,arguments)}},i={}.hasOwnProperty,j=function(a,b){function d(){this.constructor=a}for(var c in b)i.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};return A=function(a){function b(){return this.close=e(this.close,this),this.listAction=e(this.listAction,this),this.resultsAction=e(this.resultsAction,this),this.matchAction=e(this.matchAction,this),this.renderValues=e(this.renderValues,this),this.render=e(this.render,this),b.__super__.constructor.apply(this,arguments)}return j(b,a),b.name="ChartPopoverView",b.prototype.descriptionLimit=50,b.prototype.valuesLimit=5,b.prototype.events={"click a.match":"matchAction","click a.results":"resultsAction","click a.list":"listAction","click a.close":"close"},b.prototype.initialize=function(a){var b,c;for(b in a)c=a[b],this[b]=c;return this.render()},b.prototype.render=function(){var a,b=this;return F(this.el).html(this.template("popover",{description:this.description,descriptionLimit:this.descriptionLimit,style:"width:300px"})),a=[],this.imService.query(this.quickPq,function(c){return c.rows(function(c){var d,e,f;for(e=0,f=c.length;e<f;e++)d=c[e],a.push(function(a){var b,c,d;for(c=0,d=a.length;c<d;c++){b=a[c];if(b.length>0)return b}}(d));return b.renderValues(a)})}),this},b.prototype.renderValues=function(a){return F(this.el).find("div.values").html(this.template("popover.values",{values:a,type:this.type,valuesLimit:this.valuesLimit}))},b.prototype.matchAction=function(a){return this.matchCb(F(a.target).text(),this.type),a.preventDefault()},b.prototype.resultsAction=function(){return this.resultsCb(this.resultsPq)},b.prototype.listAction=function(){return this.listCb(this.resultsPq)},b.prototype.close=function(){return F(this.el).remove()},b}(a.View),{InterMineWidget:d,ChartWidget:h,TableWidget:k,EnrichmentWidget:l,CoreModel:n,EnrichmentRowView:s,TableRowView:t,TableView:u,TablePopoverView:v,ChartView:w,EnrichmentPopoverView:x,EnrichmentView:z,ChartPopoverView:A}};var F,G,D=function(a,b){return function(){return a.apply(b,arguments)}},d={}.hasOwnProperty,e=function(a,b){function e(){this.constructor=a}for(var c in b)d.call(b,c)&&(a[c]=b[c]);return e.prototype=b.prototype,a.prototype=new e,a.__super__=b.prototype,a},H=[].slice,I=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};F=window.jQuery||window.Zepto,G=function(){function b(b,c){var d=this;this.service=b,this.token=c!=null?c:"",this.all=D(this.all,this),this.table=D(this.table,this),this.enrichment=D(this.enrichment,this),this.chart=D(this.chart,this),intermine.load(this.resources,function(){return F=window.jQuery,e(a,E(window.Backbone)),d.wait=!1})}return b.name="Widgets",b.prototype.VERSION="d3",b.prototype.wait=!0,b.prototype.resources=[{name:"JSON",path:"http://cdn.intermine.org/js/json3/3.2.2/json3.min.js",type:"js"},{name:"jQuery",path:"http://cdn.intermine.org/js/jquery/1.7.2/jquery.min.js",type:"js",wait:!0},{name:"_",path:"http://cdn.intermine.org/js/underscore.js/1.3.3/underscore-min.js",type:"js",wait:!0},{name:"Backbone",path:"http://cdn.intermine.org/js/backbone.js/0.9.2/backbone-min.js",type:"js",wait:!0},{name:"d3",path:"http://cdn.intermine.org/js/d3/2.8.1/d3.v2.min.js",type:"js"},{path:"http://cdn.intermine.org/js/intermine/imjs/latest/model.js",type:"js"},{path:"http://cdn.intermine.org/js/intermine/imjs/latest/query.js",type:"js"},{path:"http://cdn.intermine.org/js/intermine/imjs/latest/service.js",type:"js"},{path:"http://cdn.intermine.org/js/canvg/latest/rgbcolor.js",type:"js"},{path:"http://cdn.intermine.org/js/canvg/latest/canvg.js",type:"js"}],b.prototype.chart=function(){var b,c=this;return b=1<=arguments.length?H.call(arguments,0):[],this.wait?window.setTimeout(function(){return c.chart.apply(c,b)},0):function(a,b,c){c.prototype=a.prototype;var d=new c,e=a.apply(d,b),f=typeof e;return f=="object"||f=="function"?e||d:d}(a.ChartWidget,[this.service,this.token].concat(H.call(b)),function(){})},b.prototype.enrichment=function(){var b,c=this;return b=1<=arguments.length?H.call(arguments,0):[],this.wait?window.setTimeout(function(){return c.enrichment.apply(c,b)},0):function(a,b,c){c.prototype=a.prototype;var d=new c,e=a.apply(d,b),f=typeof e;return f=="object"||f=="function"?e||d:d}(a.EnrichmentWidget,[this.service,this.token].concat(H.call(b)),function(){})},b.prototype.table=function(){var b,c=this;return b=1<=arguments.length?H.call(arguments,0):[],this.wait?window.setTimeout(function(){return c.table.apply(c,b)},0):function(a,b,c){c.prototype=a.prototype;var d=new c,e=a.apply(d,b),f=typeof e;return f=="object"||f=="function"?e||d:d}(a.TableWidget,[this.service,this.token].concat(H.call(b)),function(){})},b.prototype.all=function(a,b,c,d){var e=this;return a==null&&(a="Gene"),this.wait?window.setTimeout(function(){return e.all(a,b,c,d)},0):F.ajax({url:""+this.service+"widgets",dataType:"jsonp",success:function(f){var g,h,i,j,k,l;if(f.widgets){k=f.widgets,l=[];for(i=0,j=k.length;i<j;i++){g=k[i];if(!(I.call(g.targets,a)>=0))continue;h=g.name.replace(/[^-a-zA-Z0-9,&\s]+/ig,"").replace(/-/gi,"_").replace(/\s/gi,"-").toLowerCase(),F(c).append(F("<div/>",{id:h,"class":"widget span6"}));switch(g.widgetType){case"chart":l.push(e.chart(g.name,b,""+c+" #"+h,d));break;case"enrichment":l.push(e.enrichment(g.name,b,""+c+" #"+h,d));break;case"table":l.push(e.table(g.name,b,""+c+" #"+h,d));break;default:l.push(void 0)}}return l}},error:function(a,b,d){return F(c).html(F("<div/>",{"class":"alert alert-error",html:""+a.statusText+" for <a href='"+e.service+"widgets'>"+e.service+"widgets</a>"}))}})},b}();if(!window.intermine)throw"You need to include the InterMine API Loader first!";window.intermine.widgets=G}).call(this)